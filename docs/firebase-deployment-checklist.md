# Firebase統合 本番環境デプロイチェックリスト

## 事前準備チェック

### 1. 環境変数設定
- [ ] `.env.production`ファイルの作成完了
- [ ] Firebase認証情報の設定確認
  - [ ] プロジェクトID: `singular-winter-370002`
  - [ ] APIキー: `AIzaSyAwh9F829QYLiWpU512Ed-3IKspIrHLpwk`
  - [ ] アプリID: `1:612916892061:web:7f78901f68fee000471f74`
- [ ] 本番用JWT秘密鍵の生成と設定
- [ ] 本番用セッション秘密鍵の生成と設定
- [ ] Redis パスワードの設定
- [ ] MySQL本番パスワードの設定

### 2. Firebaseコンソール設定
- [ ] Firebaseプロジェクトの本番設定確認
- [ ] Firebase Authenticationの有効化
- [ ] Firestoreデータベースの作成
- [ ] Firebase Storageバケットの設定
- [ ] セキュリティルールの適用
- [ ] サービスアカウントキーの生成とダウンロード

### 3. インフラストラクチャ準備
- [ ] SSL証明書の取得と設定
- [ ] ドメイン名の設定
- [ ] ロードバランサーの設定（必要な場合）
- [ ] CDNの設定（必要な場合）

## デプロイ前チェック

### 4. コードベース確認
- [ ] 最新のコードがmasterブランチにマージされている
- [ ] すべてのテストがパスしている
- [ ] セキュリティスキャンが完了している
- [ ] コードレビューが完了している

### 5. データベース準備
- [ ] 本番データベースのバックアップ取得
- [ ] マイグレーションスクリプトの準備
- [ ] データベース接続情報の確認

### 6. Docker イメージ準備
- [ ] Dockerイメージのビルド成功確認
- [ ] イメージのセキュリティスキャン実施
- [ ] イメージサイズの最適化確認

## デプロイ実施

### 7. 段階的デプロイ
- [ ] ステージング環境へのデプロイ
- [ ] ステージング環境での動作確認
- [ ] カナリアデプロイの実施（10%のトラフィック）
- [ ] カナリア環境での監視（30分間）
- [ ] 全体デプロイの実施

### 8. Firebase統合確認
- [ ] Firebase Authenticationの動作確認
  - [ ] ユーザー登録機能
  - [ ] ログイン機能
  - [ ] パスワードリセット機能
- [ ] Firestoreデータ同期の確認
- [ ] Firebase Storageへのファイルアップロード確認
- [ ] セキュリティルールの動作確認

### 9. システム全体確認
- [ ] APIエンドポイントの応答確認
- [ ] フロントエンドの表示確認
- [ ] データベース接続の確認
- [ ] Redis接続の確認
- [ ] ログ出力の確認

## デプロイ後チェック

### 10. モニタリング設定
- [ ] Prometheusメトリクスの確認
- [ ] Grafanaダッシュボードの動作確認
- [ ] アラート設定の確認
- [ ] エラー率の監視

### 11. パフォーマンス確認
- [ ] ページロード時間の測定
- [ ] API応答時間の測定
- [ ] データベースクエリ性能の確認
- [ ] メモリ使用量の確認

### 12. セキュリティ確認
- [ ] HTTPS接続の確認
- [ ] セキュリティヘッダーの確認
- [ ] CORS設定の確認
- [ ] Rate Limitingの動作確認

## ロールバック準備

### 13. ロールバック手順の確認
- [ ] 前バージョンのDockerイメージタグの記録
- [ ] データベースロールバックスクリプトの準備
- [ ] ロールバック実施手順書の確認
- [ ] ロールバック権限の確認

### 14. 緊急連絡体制
- [ ] オンコール担当者の確認
- [ ] エスカレーションパスの確認
- [ ] 緊急連絡先リストの更新

## 完了確認

### 15. 最終確認
- [ ] すべてのチェック項目が完了
- [ ] ステークホルダーへの完了報告
- [ ] デプロイログの保存
- [ ] 次回デプロイへの改善点の記録

---

## 重要な注意事項

1. **段階的デプロイ**: 必ず段階的にデプロイし、各段階で動作確認を行う
2. **監視**: デプロイ後最低1時間は継続的に監視する
3. **ロールバック**: 問題が発生した場合は即座にロールバックする
4. **コミュニケーション**: チーム全体に進捗を共有する

## 緊急時の対応

問題が発生した場合：
1. 即座にロールバックを実施
2. インシデントレポートを作成
3. 根本原因の分析を開始
4. 修正計画を立案